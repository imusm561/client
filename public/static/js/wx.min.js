const scriptParams=new URLSearchParams(document.currentScript.src.split("?")[1]),appid=scriptParams.get("appid"),scope=scriptParams.get("scope"),redirect=()=>{const e=new URL(window.location.href);e.searchParams.delete("code"),e.searchParams.delete("state"),window.location.href=e.toString()},getWeixinUserInfo=e=>{if(null!==appid&&null!==scope){const t=new URLSearchParams(window.location.search),c=t.get("code"),a=t.get("state");if(null!==c&&null!==a){const t="https://www.imusm.cn/lcdp/cor/weixin/authorize",a=new URLSearchParams;a.append("appid",appid),a.append("code",c),fetch(`${t}?${a.toString()}`).then((e=>e.json())).then((t=>{200===t.code?e&&e(t.data):redirect()})).catch((e=>{redirect()}))}else window.location.href=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appid}&redirect_uri=${encodeURIComponent(window.location.href)}&response_type=code&scope=${scope}&state=STATE#wechat_redirect`}};